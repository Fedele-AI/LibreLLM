"""
Dataset information and preview script.
Shows what data will be used for training, including historical texts.
"""
from datasets import load_dataset


def preview_dataset():
    """Preview all datasets that will be used for training."""
    print("="*80)
    print("LibreLLM Training Datasets Preview")
    print("="*80)
    
    # Dataset 1: TinyStories
    print("\n" + "="*80)
    print("Dataset 1: TinyStories")
    print("="*80)
    print("Name: roneneldan/TinyStories")
    print("License: MIT")
    print("Description: High-quality short stories for children")
    print("              Generated by GPT-3.5 and GPT-4")
    print("              Perfect for coherent English narrative structure")
    print("Training split: train[:10%]")
    
    print("\nLoading a small sample...")
    try:
        dataset = load_dataset("roneneldan/TinyStories", split="train[:50]")
        print(f"Sample size: {len(dataset)} stories")
        
        lengths = [len(story["text"]) for story in dataset]
        avg_length = sum(lengths) / len(lengths)
        
        print(f"Average story length: {avg_length:.0f} characters")
        
        print("\n--- Sample Story ---")
        print(dataset[0]["text"][:300] + "...")
    except Exception as e:
        print(f"Could not load sample (this is normal if not downloaded yet)")
        print(f"The dataset will be downloaded automatically during training.")
    
    # Dataset 2: OpenWebText
    print("\n" + "="*80)
    print("Dataset 2: OpenWebText")
    print("="*80)
    print("Name: Skylion007/openwebtext")
    print("Description: High-quality web text extracted from Reddit")
    print("              Diverse topics and writing styles")
    print("Training split: train[:2%]")
    
    # Dataset 3: Wikipedia (Filtered)
    print("\n" + "="*80)
    print("Dataset 3: Wikipedia (Filtered)")
    print("="*80)
    print("Name: wikipedia (20220301.en)")
    print("Description: Wikipedia articles for factual English")
    print("Filters: Georgia, American Revolution, colonial, founding fathers,")
    print("         Constitution, Bill of Rights")
    print("Training split: train[:1%]")
    
    # Dataset 4: Project Gutenberg
    print("\n" + "="*80)
    print("Dataset 4: Project Gutenberg Books")
    print("="*80)
    print("Name: sedthh/gutenberg_english")
    print("Description: Classic literature and historical texts from Project Gutenberg")
    print("              ~48,000 public domain English books")
    print("Filters: history, philosophy, government, liberty, revolution, politics")
    print("Training split: train[:5%]")
    print("Size: ~2-3 GB")
    
    # Dataset 5: American Stories
    print("\n" + "="*80)
    print("Dataset 5: American Stories (Historical Newspapers)")
    print("="*80)
    print("Name: dell-research-harvard/AmericanStories")
    print("Description: 20 million historical US newspaper articles")
    print("              From Library of Congress Chronicling America collection")
    print("              Covers Georgia history, American Revolution, founding era")
    print("Training split: train[:0.5%]")
    print("License: CC-BY-4.0")
    
    # Dataset 6: Pile of Law - Founding Documents
    print("\n" + "="*80)
    print("Dataset 6: Pile of Law - Founding Documents")
    print("="*80)
    print("Name: pile-of-law/pile-of-law (founding_docs subset)")
    print("Description: Letters from U.S. founding fathers")
    print("              Primary sources from Washington, Jefferson, Madison, etc.")
    print("Training split: full dataset")
    print("License: CC BY-NC-SA 4.0")
    
    # Dataset 7: Pile of Law - Constitutions
    print("\n" + "="*80)
    print("Dataset 7: Pile of Law - Constitutions")
    print("="*80)
    print("Name: pile-of-law/pile-of-law (constitutions subset)")
    print("Description: World constitutions including US Constitution")
    print("              State constitutions including Georgia")
    print("Training split: train[:50%]")
    print("License: CC BY-NC-SA 4.0")
    
    # Dataset 8: Custom Historical Texts
    print("\n" + "="*80)
    print("Dataset 8: Custom Historical Texts (Curated)")
    print("="*80)
    print("Description: Curated historical content for domain expertise")
    print("\nTopics covered:")
    print("  1. Georgia State History")
    print("     - Colonial founding by James Oglethorpe (1733)")
    print("     - Named after King George II")
    print("     - Role in American Revolution")
    print("     - Ratification of Constitution (4th state, Jan 2, 1788)")
    print("     - Native American heritage (Creek and Cherokee)")
    print("     - Civil War and Reconstruction")
    print("     - Civil Rights Movement")
    print()
    print("  2. Second Amendment")
    print("     - Full text and ratification (Dec 15, 1791)")
    print("     - Bill of Rights context")
    print("     - Individual right to bear arms")
    print("     - Historical context and Founding Fathers' intent")
    print("     - Supreme Court interpretations (Heller, McDonald)")
    print()
    print("  3. John Locke - Pre-Revolutionary Philosophy")
    print("     - Two Treatises of Government (1689)")
    print("     - Natural rights: life, liberty, property")
    print("     - Social contract theory")
    print("     - Consent of the governed")
    print("     - Right to revolution")
    print("     - Influence on American Founding Fathers")
    print()
    print("  4. Enlightenment Philosophy")
    print("     - Montesquieu: Separation of powers")
    print("     - Rousseau: Social contract")
    print("     - English common law traditions")
    print("     - Colonial thinkers: Adams, Paine, Henry")
    print()
    print("  5. Constitutional Framework")
    print("     - U.S. Constitution (1787)")
    print("     - Bill of Rights (1791)")
    print("     - Individual liberties and protections")
    print("     - Checks and balances")
    print("     - Federalism")
    
    print("\n" + "="*80)
    print("Sample Historical Content")
    print("="*80)
    
    print("\n--- Georgia History Sample ---")
    print("""The State of Georgia, one of the original Thirteen Colonies, was founded in 1733 
by James Oglethorpe. It was named after King George II of Great Britain. Georgia 
was the last of the British colonies to be established in North America. The colony 
was conceived as a place where debtors and the unemployed could start anew...""")
    
    print("\n--- Second Amendment Sample ---")
    print("""The Second Amendment to the United States Constitution reads: 'A well regulated 
Militia, being necessary to the security of a free State, the right of the people 
to keep and bear Arms, shall not be infringed.' This amendment was adopted on 
December 15, 1791, as part of the Bill of Rights...""")
    
    print("\n--- John Locke Philosophy Sample ---")
    print("""John Locke's Two Treatises of Government, published in 1689, is a foundational 
text of classical liberalism and influenced the American Revolution. Locke argued 
that government derives its authority from the consent of the governed. He proposed 
the concept of natural rights: life, liberty, and property...""")
    
    print("\n" + "="*80)
    print("Training Configuration Summary")
    print("="*80)
    print("\nTokenizer: Mistral (mistralai/Mistral-7B-v0.1)")
    print("  - Better subword tokenization than GPT-2")
    print("  - Vocab size: ~32,000 tokens")
    print("  - Improved handling of diverse text")
    print("  - SentencePiece-based for better multilingual support")
    print()
    print("Total expected samples: ~200,000")
    print("Estimated total size: ~15-25 GB (compressed)")
    print("Context length: 8192 tokens (8k)")
    print("Batch size: 4")
    print("Max training steps: 10,000")
    print()
    print("Dataset Breakdown:")
    print("  • TinyStories (8%): ~20,000 samples - narrative structure")
    print("  • OpenWebText (2%): ~15,000 samples - modern English")
    print("  • Wikipedia (1%, filtered): ~5,000 samples - factual content")
    print("  • Gutenberg (5%, filtered): ~25,000 samples - classic literature")
    print("  • American Stories (0.5%): ~100,000 samples - historical news")
    print("  • Pile of Law - Founding Docs: ~1,000 samples - primary sources")
    print("  • Pile of Law - Constitutions (50%): ~500 samples - legal documents")
    print("  • Custom Historical Texts: 6 curated essays")
    print()
    print("Expected outcomes:")
    print("  ✓ Coherent English narrative structure")
    print("  ✓ Deep knowledge of Georgia state history")
    print("  ✓ Understanding of Second Amendment and Bill of Rights")
    print("  ✓ Familiarity with pre-revolutionary philosophy (Locke, Rousseau, Montesquieu)")
    print("  ✓ Constitutional framework and founding documents knowledge")
    print("  ✓ Enlightenment principles and American founding era")
    print("  ✓ Historical context from newspapers and primary sources")
    
    print("\n" + "="*80)
    print("Ready to train!")
    print("Run: python train.py")
    print("="*80)


if __name__ == "__main__":
    preview_dataset()

