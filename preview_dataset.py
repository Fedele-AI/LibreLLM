"""
Dataset information and preview script.
Shows what data will be used for training.
"""
from datasets import load_dataset


def preview_dataset():
    """Preview the TinyStories dataset."""
    print("="*60)
    print("TinyStories Dataset Preview")
    print("="*60)
    
    print("\nDataset: roneneldan/TinyStories")
    print("License: MIT")
    print("Description: High-quality short stories for children")
    print("              Generated by GPT-3.5 and GPT-4")
    print("              Perfect for training small language models")
    
    print("\nLoading a small sample...")
    # Load just a tiny sample to preview
    dataset = load_dataset("roneneldan/TinyStories", split="train[:100]")
    
    print(f"\nSample size: {len(dataset)} stories")
    
    # Show statistics
    lengths = [len(story["text"]) for story in dataset]
    avg_length = sum(lengths) / len(lengths)
    
    print(f"Average story length: {avg_length:.0f} characters")
    print(f"Shortest story: {min(lengths)} characters")
    print(f"Longest story: {max(lengths)} characters")
    
    # Show examples
    print("\n" + "="*60)
    print("Example Stories:")
    print("="*60)
    
    for i in range(min(3, len(dataset))):
        print(f"\n--- Story {i+1} ---")
        story = dataset[i]["text"]
        # Truncate if too long
        if len(story) > 300:
            print(story[:300] + "...")
        else:
            print(story)
    
    print("\n" + "="*60)
    print("Full Training Configuration")
    print("="*60)
    print("\nDataset split: train[:10%]")
    print("Expected stories: ~20,000-25,000")
    print("Max samples: 50,000")
    print("Download size: ~2-3 GB")
    print("\nThis dataset is:")
    print("  ✓ Open source (MIT License)")
    print("  ✓ High quality (human-curated prompts)")
    print("  ✓ Small size (perfect for quick experiments)")
    print("  ✓ Clean text (no profanity or inappropriate content)")
    print("  ✓ Educational (designed for small models)")
    
    print("\n" + "="*60)
    print("Ready to train!")
    print("Run: python train.py")
    print("="*60)


if __name__ == "__main__":
    preview_dataset()
